= Using IntelliJ

:Notice: Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at. http://www.apache.org/licenses/LICENSE-2.0 . Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR  CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.

This section describes how to install and setup JetBrains' IntelliJ IDEA, then how to import an application into IntelliJ and run it.


== Installing and Importing

This section covers installation and setup.
These notes/screenshots were prepared using IntelliJ IDEA Community Edition 2023.1.2, but is believed to be compatible with more recent versions/other editions of the IDE.

=== Download and Install

https://www.jetbrains.com/idea/download/[Download] latest version of IntelliJ Community Edition, and install.


=== Import Project

In IntelliJ a project can contain multiple modules; these need not be physically located together.

Download either the xref:docs:starters:helloworld.adoc[HelloWorld] or xref:docs:starters:simpleapp.adoc[SimpleApp] starter app to your filesystem.

From the welcome screen, select "open project":

image::015-import-project/010-welcome.png[width="700px"]

Navigate to the top-level pom.xml of the starter app:

image::015-import-project/020-import-pom.png[width="500px"]

Acknowledge that the containing directory can be trusted:

image::015-import-project/025-trust-directory.png[width=500]

Project opened:

image::015-import-project/030-imported.png[width="1000px"]


Use menu:File[Project Structure] to confirm that JDK 11 is configured:

image::015-import-project/040-project-structure.png[width="800px"]


== Configuring

=== Compiler Settings

There are a number of compiler settings that influence the compiler.
We highly recommend you set these.

On the *Compiler* Settings page, ensure that `build automatically` is enabled, and optionally `compile independent modules in parallel`.
You might also want to increase the heap size, eg to 2048.

.IntelliJ Compiler Settings
image::040-other-settings-compiler/010-build-automatically.png[width="1000px"]


On the *Annotation Processors* page, confirm that these are enabled for all modules with the `... sources directory` correctly defined.
(In most recent editions of IntelliJ, this is detected automatically; no changes are required).

.IntelliJ Annotation Processor Settings
image::040-other-settings-compiler/020-annotation-processor.png[width="1000px"]

[TIP]
====
If using QueryDSL, this setting enables the generation of the `Q*` classes for type-safe queries.

It is also required for frameworks such as link:https://projectlombok.org[Lombok].
====




=== Editor Settings

On the *Auto Import* settings page, check the `optimize imports on the fly` and `add unambiguous imports on the fly`

.IntelliJ Auto Import Setting
image::044-other-settings-misc/010-auto-import.png[width="1000px"]


== Plugins

You might want to set up some additional plugins.
You can do this using `File > Settings > Plugins` (or equivalently `File > Other Settings > Configure Plugins`).

Highly recommended are:

* Lombok plugin (bundled with the IDE, and pre-enabled)
+
If you plan to use link:https://projectlombok.org[Project Lombok] to reduce boilerplate.

* link:https://plugins.jetbrains.com/plugin/7179?pr=idea[Maven Helper] plugin

* link:https://plugins.jetbrains.com/plugin/7391-asciidoc[AsciiDoctor] plugin
+
Extremely useful if you are doing any authoring of documents (plugin's git repo is link:https://github.com/asciidoctor/asciidoctor-intellij-plugin[here])

* link:https://plugins.jetbrains.com/plugin/15635-diagrams-net-integration[diagrams.net] plugin
*
Allows diagrams to be authored within the IDE; works well with the AsciiDoctor plugin.




== Running

Let's see how to run both the app and the tests.

We run the application by creating a Run configuration, using `Run > Edit Configurations`.

We also configure dynamic class weaving for the xref:pjpa:ROOT:about.adoc[JPA/EclipseLink] ORM.


=== Running the App (JPA)

The screenshot below shows a run configuration for JPA:

image::110-running-the-app/012-run-configuration-jpa.png[width=1000]

With xref:pjpa:ROOT:about.adoc[JPA/Eclipselink], the classes can optionally be "weaved" in order to support lazy loading and (more performant) dirty object tracking.
This is typically done dynamically at runtime, using a Java agent.
The xref:docs:starters:simpleapp.adoc[SimpleApp] and xref:docs:starters:helloworld.adoc[HelloWorld] starter apps demonstrate this, bundling the `spring-instrument.jar` file.
To run, use:

[source,bash]
----
-javaagent:lib/spring-instrument.jar
----

as a JVM argument (where the system properties also are located.)


=== Running the Unit Tests

The easiest way to run the unit tests is just to right click on the relevant package in the _Project Window_, and choose run unit tests.
Hopefully your tests will pass (!).

.Running Unit Tests from Project Explorer
image::110-running-the-app/030-running-unit-tests.png[width="500px"]

As a side-effect, this will create a run configuration, very similar to the one we manually created for the main app.

=== Running the Integration Tests

Integration tests can be run in the same way as unit tests.

One approach is to initially run the tests use the right click on the `integtests` module:

.Running Integ Tests from Project Explorer
image::110-running-the-app/045-running-integ-tests.png[width="800px"]

There are also tests in the `webapp-tests` module:

image::110-running-the-app/046-running-integ-tests-webapp-tests.png[width=800]


